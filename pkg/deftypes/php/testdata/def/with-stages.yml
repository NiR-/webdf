# syntax=akerouanton/webdf-builder:test9
type: php
fpm: true
version: 7.0.29
infer: false

extensions:
  intl: "*"
  pdo_mysql: "*"
  soap: "*"

source_dirs:
  - 'generated/'

extra_scripts:
  - 'gencode.php'

stateful_dirs:
  - 'public/uploads'

config_files:
  fpm.conf: 'docker/app/fpm.conf'

integrations:
  - symfony

post_install:
  - echo some command

stages:
  dev:
    dev: true
    config_files:
      php.ini: 'docker/app/php.dev.ini'
    healthcheck: false

  prod:
    config_files:
      php.ini: 'docker/app/php.prod.ini'
    extensions:
      apcu: "*"
      opcache: "*"
    healthcheck: true
    integrations:
      - blackfire

  worker:
    derive_from: prod
    config_files:
      fpm.conf: ''
    composer_dump:
      apcu: true
    source_dirs:
      - 'worker/'
    extra_scripts:
      - 'bin/worker'
    stateful_dirs:
      - 'data/imports'
    post_install:
      - echo some other command
    healthcheck: false
    fpm: false
